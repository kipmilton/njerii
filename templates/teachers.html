{% extends 'base.html' %}
{% load static %}
{% block title %} Teachers Dashboard {% endblock %}

{% block Content %}
<!-- Teachers Dashboard Section -->
<section id="teachers-dashboard" class="teachers-dashboard section">
  <div>
    <h2 class="section-title">Teachers Dashboard</h2>

    <!-- Add New Subject -->
    <div class="add-subject card p-4 mb-4">
      <h3>Add New Subject</h3>
      <form method="POST" enctype="multipart/form-data" action="{% url 'myapp:add_subject' %}">
        {% csrf_token %}
        {{ subject_form.as_p }}
        <button type="submit" name="add_subject" class="btn btn-success">Add Subject</button>
      </form>
    </div>

    <!-- Upload Assignment -->
    <div class="upload-assignment card p-4 mb-4">
      <h3>Upload New Assignment</h3>
      <form method="POST" enctype="multipart/form-data" action="{% url 'myapp:upload_assignment' %}">
        {% csrf_token %}
        {{ assignment_form.as_p }}
        <button type="submit" name="upload_assignment" class="btn btn-success">Upload</button>
      </form>
    </div>

    

    <!-- Submitted Assignments -->
    <div class="submitted-assignments card p-4">
      <h3>Submitted Assignments</h3>
      {% if submissions %}
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Student</th>
              <th>Assignment</th>
              <th>Status</th>
              <th>Submission</th>
              <th>Grade</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for submission in submissions %}
            <tr>
              <td>{{ submission.student.username }}</td>
              <td>{{ submission.assignment.title }}</td>
              <td>
                <span class="badge {% if submission.status == 'Attempted' %} bg-warning {% else %} bg-secondary {% endif %}">
                  {{ submission.status }}
                </span>
              </td>
              <td>
                <a href="{{ submission.image.url }}" target="_blank">
                  <img src="{{ submission.image.url }}" width="50" height="50" alt="Submission Image" class="rounded">
                </a>
              </td>
              <td>{{ submission.grade|default:"Not Graded" }}</td>
              <td>
                <a href="{% url 'grade_submission' submission.id %}" class="btn btn-primary btn-sm">Grade</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="text-muted">No assignments submitted yet.</p>
      {% endif %}
    </div>
  </div>
</section>

{% endblock %}
